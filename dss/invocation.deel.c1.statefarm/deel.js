"use strict";(()=>{var be=/AdobeLaunchHosting|(ensighten|ddc\.statefarm)\.com/,_=/https:\/\/ddc\.statefarm\.com\/.+\/Bootstrap\.js/,g=[],k=(n,l,f)=>{let i=f?`;${new Date().setTime(Date.now()+f*864e7)}`:"";document.cookie=`${n}=${l}${i};path=/`},C=n=>Object.fromEntries(document.cookie.split("; ").map(l=>l.split("=").map(decodeURIComponent)))[n],Z=n=>{k(n,"",-1)},J=async()=>{let n=window.s?.getKeyVal?.("traffic")??localStorage.getItem("traffic")??"";if(n==="external"&&Q(),n){Y(n);return}try{let l=await fetch("https://online.statefarm.com/ddc/trafficdetection.aspx");if(l.status===200&&l.statusText==="OK"&&(n="external"),l.status===404&&l.statusText==="Internal"&&(n="internal"),!n||(Y(n),n==="internal"))return;Q()}catch{}},Ee=(n,l)=>()=>{let f=new Error(`The ${l} service conflicts with user privacy preferences and cannot be provided.`),{promise:i,resolve:c,reject:m}=Promise.withResolvers(),u=C(`STATEFARM_ENSIGHTEN_PRIVACY_${n}`);if(u==="0"||navigator.globalPrivacyControl)return m(f),i;let d=_.test(g.find(({name:b})=>b==="Analytics")?.src??""),v=[...document.scripts].some(({src:b})=>_.test(b)),A=performance.getEntries().some(({name:b})=>_.test(b));return!d&&!v&&!A?(c(!0),i):window.Bootstrapper?"gateway"in window.Bootstrapper?(u??=window.Bootstrapper.gateway.getUserPreference(n),u==="0"?(m(f),i):(c(!0),i)):(c(!0),i):(c(!1),i)},X=n=>Ee("Marketing",n),K=n=>{let{promise:l,resolve:f,reject:i}=Promise.withResolvers(),c=setTimeout(()=>{n.removeEventListener("error",u),n.removeEventListener("load",m),n.remove(),i(new Error(`Stopped waiting for ${n.name} to load after 2.5 seconds. It may eventually load, but it is not guaranteed`))},2500),m=d=>{clearTimeout(c),f(d)},u=d=>{clearTimeout(c),n.remove();let v="message"in d?d.message:"detail"in d?d.detail:d.target?.name==="Analytics"&&d.target?.src==="https://tms/"?"not recognizing the domain where Invocation was requested":"an unknown event";i(new Error(`${n.name} is unavailable on this page due to ${v}`))};return n.addEventListener("error",u),n.addEventListener("load",m),queueMicrotask(()=>{document.head.prepend(n)}),l},ee=(n=0)=>{let{promise:l,resolve:f}=Promise.withResolvers(),i=d=>{c&&clearTimeout(c),m.disconnect(),f(d)},c=0;n>0&&(c=+setTimeout(i,n,!1));let m=new PerformanceObserver(d=>{d.getEntries().find(W)&&(m.disconnect(),i(!0))});return performance.getEntriesByType("resource").find(W)?(i(!0),l):(m.observe({entryTypes:["resource"]}),l)},W=n=>n instanceof PerformanceResourceTiming&&(n.initiatorType==="beacon"||n.initiatorType==="image"||n.initiatorType==="img"||n.initiatorType==="xmlhttprequest")&&n.name.includes("/ss/sf"),Le=({name:n})=>n.includes("Employee"),te=async n=>{let l=n.map(async i=>{let{attrs:c={async:!0},preload:m=()=>{},name:u,src:d,when:v=()=>!0}=i,{origin:A,pathname:b}=new URL(i.src),S=w=>{try{let{href:L,origin:T,pathname:I,searchParams:P}=new URL(w);if(u!=="Employee Identification"||!L.includes("ldap"))return A===T&&b===I;let j=P.get("callback");return j==="deelLDAP"||j==="sfnet.ldap.data"}catch{return!1}};if(d.includes("com/statefarm/")&&(c.async=!1),[...document.scripts].find(({src:w})=>S(w))??performance.getEntries().find(w=>w.initiatorType==="script"&&S(w.name)))return new CustomEvent("load",{detail:`${u} already available`});m();let y=Object.assign(document.createElement("script"),{...c,src:d,name:u});if("async"in c&&(c.async?(y.setAttribute("async",""),y.async=!0):(y.removeAttribute("async"),y.async=!1)),"defer"in c&&(c.defer?(y.setAttribute("defer",""),y.defer=!0):(y.removeAttribute("defer"),y.defer=!1)),y.addEventListener("load",()=>{console.debug(`DEEL Invocation: ${u} loaded`)}),await v())return K(y);let M=setInterval(()=>{let w=()=>{clearInterval(M),K(y)},L=v();if(!(L instanceof Promise)){L&&w();return}L.then(T=>{T&&w()})});throw new Error(`Initial readiness check for ${u} failed; Retries will be attempted.`)});console.debug(`DEEL Invocation: Processed ${l.length} service scripts`),(await Promise.allSettled(l)).forEach(i=>{if(i.status==="fulfilled"){if(!("detail"in i.value))return;console.log(i.value.detail);return}let c=typeof i.reason=="string"?i.reason.replace(/Error: /,""):i.reason.message;console.warn(`DEEL Invocation: Encountered the following issue: ${c}`)})};var x=n=>n<1e3?`${n===Math.floor(n)?n:+n.toFixed(2)}ms`:n<6e4?`${Math.floor(n/1e3)}s ${x(n%1e3)}`:`${Math.floor(n/6e4)}m ${x(n%6e4)}`,Q=()=>{let n=g.findIndex(Le);n<0||(g.splice(n,1),console.debug("DEEL Invocation: Removed unneeded service"))},Y=n=>{let l=setInterval(()=>{if(!window.s||!("dataLayer"in window&&"get"in window.dataLayer&&window.dataLayer.get(Symbol.for("DEELReady"))))return;clearInterval(l),window.s.eVar48??=n,window.s.eVar108??=new Date().toUTCString();let f=[...document.scripts].find(({src:i})=>be.test(i));if(!window.s.eVar121&&f){let i=f.src.includes("AdobeLaunchHosting")?"launch":"ens";window.s.eVar121=`${i}|deel`}dataLayer.set({traffic:n}),window.s.setKeyVal?.("traffic",n),localStorage.setItem("traffic",n)},100)};Object.assign(window,{createCookie:k,readCookie:C,eraseCookie:Z});(()=>{var n=t=>r=>t.match(new RegExp(r.replaceAll(l,""),"i"))?.[0]??"",l=/-/g,f=/\$/g,i=/(?=[A-Z])/,c=/(^_)/,m=/(\d+)_(\d+)/g,u=/_/g,d=/"[^"]*?"/g,v=t=>t.replace(c,"").replaceAll(f,"#").replaceAll(m,"$1.$2").replaceAll(u," ").split(i).reduce((r,a)=>`${r}${r?"-":""}${a.toLowerCase()}`,"").replaceAll(d,n(t)),A=["debug","error","group","groupCollapsed","info","log","warn"],b=t=>t!==""?`%c${t}`:t,S=()=>console.groupEnd(),B=t=>[t,(r,...a)=>{for(;a.length<r.length;)a.push("");console[t](y(r,a),...a)}],y=(t,{length:r})=>(r?t.map(b).filter(Boolean):t).join(""),M=()=>Object.fromEntries([["groupEnd",S],...A.map(B)]),w=t=>({install:r=>{if(r.id in t.plugins)return t.warn`Cannot overwrite an existing plugin`;let a=r.install(t);r.uninstall&&(a.uninstall=r.uninstall),t.plugins[r.id]=a},uninstall:r=>{r in t.plugins&&(t.plugins[r]?.uninstall?.(t),delete t.plugins[r])}}),L=t=>({get(r,a,e){if(typeof a=="symbol"||a in r)return Reflect.get(r,a,e);let o=t.at(-1),s=v(a);return!t.length||o.length>1?t.push([s]):o.push(s),e}}),T=({fixed:t=[],plugins:r=[]}={})=>{let a=[],e=()=>[...t,...a.splice(0,a.length)].map(E=>E.join(":")).join(";"),o=()=>T({fixed:[...t,...a.splice(0,a.length)]}),s=(...E)=>T({fixed:[...t,...a.splice(0,a.length),...E.flatMap(O=>O.split(";").map(R=>R.split(":")))]}),h={...M(),inject:s,fix:o},p=new Proxy(Object.assign(e,h),L(a));return p.plugins=w(p),r.forEach(p.plugins.install),p},I=T(),P="#1a7558",j="#fff",F="1rem",N=I.borderRadius[F].borderStyle.none_none_ridge_groove.fontFamily['"Century Gothic"'].margin._0_25rem.padding._0_75rem(),ne=I.inject(N).background[P].borderColor[j].color[j].fontSize[F].fontWeight.bolder(),re=I.inject(N).background[j].borderColor[P].color[P].fontSize._0_8125rem.fontWeight.bold(),oe="\u{1F4E3} Welcome to the new Data Layer v2 API! \u{1F4E3}",ae="\u{1F389} The Data Layer now provides a set of new & improved methods for working with your data! For more details about the Data Layer, contact your \u{1F4A1} DCV analyst \u{1F4A1}",U=!1,$=()=>{U||(I.log([oe,`
`,ae],ne,"",re),U=!0)},ie=Object.freeze({deleteProperty(t,r){$();let a=function(){return!this}();return t.delete(r)||a},get(t,r){return r=r.toString(),r in t?t[r]:r==="then"||r==="catch"||r==="finally"?Reflect.get(t,r):($(),t.get(r))},ownKeys(t){return $(),Reflect.ownKeys(t)},set(t,r,a){r=r.toString(),$();let e=function(){return!this}();return t.set(r,a)||e}}),z=Symbol.for("DEELReady"),V=Symbol.for("isSPA"),se=Object.freeze({clientID:"",da:{},deploymentIds:[],product:"",screenChannel:"",screenId:"",state:"",visitor:""}),le=Object.freeze([]),q=Object.freeze([z,V,"clientID","da","deploymentIds","language","product","queryParams","screenChannel","screenId","state","title","urlPath","visitor"]),ce=()=>{if(!globalThis.window||!globalThis.window.document||!globalThis.window.location)throw new Error("Attempted to generate page values, but the global scope was missing one or both of 'document' and 'location' objects.");let{window:t}=globalThis,{lang:r}=t.document.documentElement,a=typeof r>"u"?"":r.split("-").shift(),{href:e,host:o,pathname:s}=t.location,h=e.includes("?")?e.split("?")[1].split("&").reduce(de,{}):{},{title:p}=t.document,[E,...O]=s.split("/").filter(Boolean),{pageChannel:R,pageName:he}={pageName:O.length?O.pop():"home",pageChannel:typeof E>"u"?"homepage":E},ye={urlHost:o,...s.split("/").reduce(fe,{})},we=/state farm insurance agent/i.test(p)&&/https:\/\/(www\.)?statefarm\.com\/agent\/./i.test(e),H=t.document.querySelector("[name=siteType]"),ve=!!H&&/microsite|mirus|qlp/i.test(H.content);return{agentSite:we||ve,language:a,queryParams:h,title:p,pageChannel:R,pageName:he,urlPath:ye}},de=(t,r)=>{let[a,e]=r.split("=");return{...t,[a]:e}},fe=(t,r)=>r?{...t,[`u${Object.keys(t).length.toString()}`]:r}:t,ue=(t,r=50)=>{let a=0,e=()=>{clearTimeout(a),a=0};return(...o)=>{a?e():t(...o),a=setTimeout(e,r)}},pe=()=>{let t=0,r=new Map,a=new Map;return{get count(){return t},run(e,o){[...(o?r:a).values()].reverse().forEach(s=>{s(e)})},set(e,o){(o?.before?r:a).set(e.toString(),ue(e,o?.delay)),t++},unset(e,o){(o?.before?r:a).delete(e.toString()),t--}}},D=(t,r)=>{if(t==null)throw new Error(r);return t},me=(t=new Map)=>{let r=new EventTarget,a=new Map;return{version:"2.1.2",view(){return Object.fromEntries([...t.entries()].map(([e,o])=>[e,o?.view?.()??o]))},delete(...e){if(e.length!==1||Array.isArray(e[0]))return Object.fromEntries(e.flat().map(p=>[p,this.delete(p)]));let o=e[0];if(typeof o!="string"&&typeof o!="symbol")throw new Error(`Invalid type used for key in .delete; expected string or symbol instead of "${typeof o}"`);if(!a.has(o))return q.includes(o)?!0:t.delete(o);let s=D(a.get(o),"Impossible watcher update attempted");s.run(dataLayer.view(),!0);let h=q.includes(o)?!0:t.delete(o);return s.run(dataLayer.view()),h},get(...e){if(e.length!==1||Array.isArray(e[0]))return Object.fromEntries(e.flat().map(s=>[s,this.get(s)]));let o=e[0];if(typeof o!="string"&&typeof o!="symbol")throw new Error(`Invalid type used for key in .get; expected string or symbol instead of "${typeof o}"`);return t.get(o)},has(...e){if(e.length!==1||Array.isArray(e[0]))return Object.fromEntries(e.flat().map(s=>[s,this.has(s)]));let o=e[0];if(typeof o!="string"&&typeof o!="symbol")throw new Error(`Invalid type used for key in .has; expected string or symbol instead of "${typeof o}"`);return t.has(o)},set(e,o){if(!e)throw new Error(`Invalid type used for key in .set; expected string or symbol instead of "${typeof e}"`);if(Array.isArray(e))throw new Error("Invalid type used for key in .set; pass an object that maps keys to values, not an array of values");if(typeof e=="object"){let h=Object.getOwnPropertySymbols(e).filter(p=>p===z||p===V).map(p=>[p,e[p]]);return[...Object.entries(e),...h].forEach(([p,E])=>this.set(p,E)),e}if(typeof e=="string"&&(le.some(h=>h.test(e))||e in this)){console.warn(`"${e}" is not allowed to be set in the Data Layer`);return}let s=o;if(o&&typeof o=="object"&&!Array.isArray(o)&&(s=G(o)),typeof e=="string"||typeof e=="symbol"){if(!a.has(e))return t.set(e,s),o;let h=D(a.get(e),"Invariant failed: Impossible watcher update attempted");h.run(dataLayer.view(),!0),t.set(e,s),h.run(dataLayer.view())}return o},emit(e){return r.dispatchEvent(e)},off(e,o,s){r.removeEventListener(e,o,s)},on(e,o,s){r.addEventListener(e,o,s)},unwatch(e,o,s){if(e&&!a.has(e))return;let h=D(a.get(e),"Invariant failed: Impossible watcher delete attempted");return h.unset(o,s),h.count||a.delete(e),this},watch(e,o,s){return e&&!a.has(e)&&a.set(e,pe()),D(a.get(e),"Invariant failed: Impossible watcher set attempted").set(o,s),this}}},G=(t={})=>{let r=me();return r.set(t),new Proxy(r,ie)},ge=(t={})=>{let r={};typeof globalThis.dataLayer?.view=="function"?r=globalThis.dataLayer.view():globalThis.dataLayer?.view?r=globalThis.dataLayer.view:globalThis.dataLayer&&(r=globalThis.dataLayer);let a=ce(),e={...se,...r,...t,...a},o=G(e);return Object.assign(globalThis,{dataLayer:o}),o};ge()})();g.push({attrs:{async:!1},name:"A/B Testing",src:"https://cdn-pci.optimizely.com/js/8421581994.js"});g.push({name:"Customer Identification",src:"https://static1.st8fm.com/en_US/applications/dasenblt_static_content/sfuid.js"});g.push({name:"Data Persistence",src:"https://deel-id-persistence.deel.c1.statefarm/index.js",attrs:{type:"module"}});g.push({name:"Analytics",src:C("ensighten")??/ensighten=test/i.test(location.href)?(k("ensighten","test"),"https://nexus.ensighten.com/statefarm/karthik/Bootstrap.js"):C("env")??/env=dev/i.test(location.href)?(k("env","dev"),"https://static1.st8fm.com/en_US/applications/AdobeLaunchHosting/dcv/libs/launch-EN1fb33cf5f8704bf39aad20a28523cf0c-development.min.js"):"https://ddc.statefarm.com/statefarm/prod/Bootstrap.js"});g.push({name:"Marketing",preload:()=>{(window.GTMdataLayer=window.GTMdataLayer??[]).push({"gtm.start":new Date().getTime(),event:"gtm.js"}),window.daGTMAdd=function(n,l,f,i,c){n[i]=n[i]||[],n[i].push({"gtm.start":new Date().getTime(),event:"gtm.js"});var m=l.getElementsByTagName(f)[0],u=l.createElement(f),d=i!="dataLayer"?"&l="+i:"";u.async=!0,u.src="https://www.googletagmanager.com/gtm.js?id="+c+d,m.parentNode.insertBefore(u,m)}},src:"https://www.googletagmanager.com/gtm.js?id=GTM-TLWQWQT&l=GTMdataLayer",when:X("Marketing")});g.push({name:"Surveys",src:"https://resources.digital-cloud.medallia.com/wdcus/6172/onsite/embed.js",when:()=>ee(10)});(async()=>{let n=performance.now();dataLayer.on("DEELReady",()=>{dataLayer.set(Symbol.for("DEELReady"),!0)},{once:!0}),console.group("DEEL Invocation"),await J(),await te(g),console.debug(`DEEL Invocation: Completed execution in ~${x(performance.now()-n)}`),console.groupEnd(),dataLayer.emit(new CustomEvent("DEELReady",{detail:new Date().toISOString()}))})();})();
